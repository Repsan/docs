---
title: "Anthropic Agents"
description: "Build agent workflows with the Anthropic Agent SDK and send traces to Respan."
---

<Accordion title="Set up Respan">
1. **Sign up** — Create an account at [platform.respan.ai](https://platform.respan.ai)
2. **Create an API key** — Generate one on the [API keys page](https://platform.respan.ai/platform/api/api-keys)
3. **Add credits or a provider key** — Add credits on the [Credits page](https://platform.respan.ai/platform/api/credits) or connect your own provider key on the [Integrations page](https://platform.respan.ai/platform/api/integrations)
</Accordion>

## What is Anthropic Agents?

The [Anthropic Agent SDK](https://github.com/anthropics/anthropic-sdk-python) enables building agent workflows powered by Claude. Use the Respan exporter to capture telemetry from agent runs and send traces to Respan.

## Setup

<Steps>
<Step title="Install packages">

<CodeGroup>
```bash Python
pip install respan-exporter-anthropic-agents
```
```bash JavaScript
npm install @respan/exporter-anthropic-agents
```
</CodeGroup>

</Step>

<Step title="Set environment variables">

```bash .env
RESPAN_API_KEY=your-respan-api-key
# Optional (default: https://api.respan.ai)
RESPAN_BASE_URL=https://api.respan.ai
```

`RESPAN_BASE_URL` is the single base URL for all Respan services. The exporter automatically appends `/api/v1/traces/ingest` to build the full endpoint.

</Step>

<Step title="Initialize the exporter and run an agent">

<CodeGroup>
```python Python
import asyncio
from claude_agent_sdk import ClaudeAgentOptions
from respan_exporter_anthropic_agents.respan_anthropic_agents_exporter import (
    RespanAnthropicAgentsExporter,
)

exporter = RespanAnthropicAgentsExporter()

async def main():
    options = exporter.with_options(
        options=ClaudeAgentOptions(
            allowed_tools=["Read", "Glob", "Grep"],
            permission_mode="acceptEdits",
        )
    )

    async for message in exporter.query(
        prompt="Analyze this repository and summarize architecture.",
        options=options,
    ):
        print(message)

asyncio.run(main())
```
```typescript JavaScript
import { RespanAnthropicAgentsExporter } from "@respan/exporter-anthropic-agents";

const exporter = new RespanAnthropicAgentsExporter();

async function main() {
  for await (const message of exporter.query({
    prompt: "Review this repository and summarize architecture.",
    options: {
      allowedTools: ["Read", "Glob", "Grep"],
      permissionMode: "acceptEdits",
    },
  })) {
    console.log(message);
  }
}

main().catch(console.error);
```
</CodeGroup>

</Step>

<Step title="View your trace">

Open the [Traces page](https://platform.respan.ai/platform/traces) in the Respan dashboard. Your trace should appear within a few seconds.

</Step>
</Steps>

## Configuration

All configuration can be passed directly to the constructor (takes priority over environment variables).

<Tabs>
<Tab title="Python">

```python
exporter = RespanAnthropicAgentsExporter(
    api_key="your_respan_key",       # Overrides RESPAN_API_KEY
    base_url="https://api.respan.ai", # Overrides RESPAN_BASE_URL
    endpoint="https://custom/ingest", # Full endpoint URL (overrides base_url)
    timeout_seconds=15,
    max_retries=3,
    base_delay_seconds=1.0,
    max_delay_seconds=30.0,
)
```

| Parameter | Required | Description |
|-----------|----------|-------------|
| `api_key` | No | Your Respan API key. Overrides `RESPAN_API_KEY`. |
| `base_url` | No | Base URL for Respan services. Overrides `RESPAN_BASE_URL`. Defaults to `https://api.respan.ai`. |
| `endpoint` | No | Full endpoint URL. Overrides `base_url`. |
| `timeout_seconds` | No | Request timeout in seconds. |
| `max_retries` | No | Maximum number of retry attempts. |
| `base_delay_seconds` | No | Base delay between retries. |
| `max_delay_seconds` | No | Maximum delay between retries. |

</Tab>

<Tab title="JavaScript">

```typescript
const exporter = new RespanAnthropicAgentsExporter({
  apiKey: "your_respan_key",
  endpoint: "https://api.respan.ai/api/v1/traces/ingest",
  timeoutMs: 15000,
  maxRetries: 3,
  baseDelaySeconds: 1,
  maxDelaySeconds: 30,
});
```

| Parameter | Required | Description |
|-----------|----------|-------------|
| `apiKey` | No | Your Respan API key. Overrides `RESPAN_API_KEY`. |
| `endpoint` | No | Full ingest endpoint URL. |
| `timeoutMs` | No | Request timeout in milliseconds. |
| `maxRetries` | No | Maximum number of retry attempts. |
| `baseDelaySeconds` | No | Base delay between retries. |
| `maxDelaySeconds` | No | Maximum delay between retries. |

</Tab>
</Tabs>

## Observability

With this integration, Respan auto-captures:

- **Agent runs** -- each agent execution as a span
- **LLM calls** -- model, input/output messages, token usage
- **Errors** -- failed runs and error details

View traces on the [Traces page](https://platform.respan.ai/platform/traces).
