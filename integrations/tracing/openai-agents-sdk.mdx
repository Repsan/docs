---
title: "OpenAI Agents"
description: "Build multi-agent workflows with the OpenAI Agents SDK and send traces to Respan."
---

<Accordion title="Set up Respan">
1. **Sign up** — Create an account at [platform.respan.ai](https://platform.respan.ai)
2. **Create an API key** — Generate one on the [API keys page](https://platform.respan.ai/platform/api/api-keys)
3. **Add credits or a provider key** — Add credits on the [Credits page](https://platform.respan.ai/platform/api/credits) or connect your own provider key on the [Integrations page](https://platform.respan.ai/platform/api/integrations)
</Accordion>

## What is OpenAI Agents?

<Note>This integration is for **agent tracing**. For the OpenAI gateway integration, see [OpenAI SDK](/integrations/gateway/openai/openai-sdk).</Note>

The [OpenAI Agents SDK](https://github.com/openai/openai-agents-python) is a lightweight framework for building multi-agent workflows with tools, handoffs, and guardrails. Respan captures every agent run as a trace so you can debug and optimize your workflows.

<Frame className="rounded-md">
<img width="100%" src="https://keywordsai-static.s3.us-east-1.amazonaws.com/docs/documentation/get-started/trace_start_tree_v0.png" alt="Agent tracing visualization" />
</Frame>

## Setup

<Steps>
<Step title="Install packages">

<CodeGroup>
```bash Python
pip install openai-agents respan-exporter-openai-agents
```
```bash JavaScript
npm install @openai/agents @respan/exporter-openai-agents
```
</CodeGroup>

</Step>

<Step title="Set environment variables">

<CodeGroup>
```bash Python
OPENAI_API_KEY=your-openai-api-key
RESPAN_API_KEY=your-respan-api-key
RESPAN_OAIA_TRACING_ENDPOINT=https://api.respan.ai/api/openai/v1/traces/ingest
```
```bash JavaScript
OPENAI_API_KEY=your-openai-api-key
RESPAN_API_KEY=your-respan-api-key
RESPAN_BASE_URL=https://api.respan.ai/api
```
</CodeGroup>

</Step>

<Step title="Initialize the exporter and run an agent">

<CodeGroup>
```python Python
import asyncio
import os
from agents import Agent, Runner
from agents.tracing import set_trace_processors, trace
from respan_exporter_openai_agents import RespanTraceProcessor

set_trace_processors([
    RespanTraceProcessor(
        api_key=os.getenv("RESPAN_API_KEY"),
        endpoint=os.getenv("RESPAN_OAIA_TRACING_ENDPOINT"),
    ),
])

async def main():
    agent = Agent(
        name="Assistant",
        instructions="You only respond in haikus.",
    )

    with trace("Hello world test"):
        result = await Runner.run(agent, "Tell me about recursion in programming.")
        print(result.final_output)

asyncio.run(main())
```
```typescript JavaScript
import { Agent, BatchTraceProcessor, run, setTraceProcessors, withTrace } from '@openai/agents';
import { RespanOpenAIAgentsTracingExporter } from '@respan/exporter-openai-agents';

setTraceProcessors([
  new BatchTraceProcessor(
    new RespanOpenAIAgentsTracingExporter(),
  ),
]);

async function main() {
  const agent = new Agent({
    name: 'Assistant',
    instructions: 'You only respond in haikus.',
  });

  const result = await withTrace('Hello World', async () => {
    return run(agent, 'Tell me about recursion in programming.');
  });
  console.log(result.finalOutput);
}

main().catch(console.error);
```
</CodeGroup>

</Step>

<Step title="View your trace">

Open the [Traces page](https://platform.respan.ai/platform/traces) in the Respan dashboard. Your trace should appear within a few seconds.

</Step>
</Steps>

## Configuration

The Python exporter accepts these constructor parameters:

| Parameter | Required | Description |
|-----------|----------|-------------|
| `api_key` | Yes | Your Respan API key. Falls back to `RESPAN_API_KEY`. |
| `endpoint` | Yes | Ingest endpoint URL. Falls back to `RESPAN_OAIA_TRACING_ENDPOINT`. |

The JavaScript exporter reads `RESPAN_API_KEY` and `RESPAN_BASE_URL` from environment variables. You can also pass metadata on a per-trace basis:

```typescript
await withTrace("My Trace", async () => {
  return run(agent, "Hello");
}, {
  metadata: { foo: "bar" }
});
```

## Tool calls

Agents can use tools to perform specific tasks. Tool calls are automatically captured in the trace.

<CodeGroup>
```python Python
import asyncio
import os
from agents import Agent, Runner, function_tool
from agents.tracing import set_trace_processors
from respan_exporter_openai_agents import RespanTraceProcessor

set_trace_processors([
    RespanTraceProcessor(
        api_key=os.getenv("RESPAN_API_KEY"),
        endpoint=os.getenv("RESPAN_OAIA_TRACING_ENDPOINT"),
    ),
])

@function_tool
def get_weather(city: str) -> str:
    return f"The weather in {city} is sunny."

agent = Agent(
    name="Hello world",
    instructions="You are a helpful agent.",
    tools=[get_weather],
)

async def main():
    result = await Runner.run(agent, input="What's the weather in Tokyo?")
    print(result.final_output)

asyncio.run(main())
```
```typescript JavaScript
import { Agent, BatchTraceProcessor, run, setTraceProcessors, tool, withTrace } from '@openai/agents';
import { RespanOpenAIAgentsTracingExporter } from '@respan/exporter-openai-agents';
import { z } from 'zod';

setTraceProcessors([
  new BatchTraceProcessor(
    new RespanOpenAIAgentsTracingExporter(),
  ),
]);

const getWeather = tool({
  name: 'get_weather',
  description: 'Get the weather for a city.',
  parameters: z.object({ city: z.string() }),
  execute: async ({ city }) => ({
    city,
    temperatureRange: '14-20C',
    conditions: 'Sunny with wind.',
  }),
});

const agent = new Agent({
  name: "Hello world",
  instructions: "You are a helpful agent.",
  tools: [getWeather],
});

async function main() {
  const result = await withTrace("Weather query", async () => {
    return run(agent, "What's the weather in Tokyo?");
  });
  console.log(result.finalOutput);
}

main().catch(console.error);
```
</CodeGroup>

## Handoffs

Agents can hand off conversations to other specialized agents. Handoff events are captured in the trace.

<CodeGroup>
```python Python
import asyncio
import os
from agents import Agent, Runner
from agents.tracing import set_trace_processors
from respan_exporter_openai_agents import RespanTraceProcessor

set_trace_processors([
    RespanTraceProcessor(
        api_key=os.getenv("RESPAN_API_KEY"),
        endpoint=os.getenv("RESPAN_OAIA_TRACING_ENDPOINT"),
    ),
])

spanish_agent = Agent(
    name="Spanish agent",
    instructions="You only speak Spanish.",
)

english_agent = Agent(
    name="English agent",
    instructions="You only speak English",
)

triage_agent = Agent(
    name="Triage agent",
    instructions="Handoff to the appropriate agent based on the language of the request.",
    handoffs=[spanish_agent, english_agent],
)

async def main():
    result = await Runner.run(triage_agent, input="Hola, ¿cómo estás?")
    print(result.final_output)

asyncio.run(main())
```
```typescript JavaScript
import { Agent, BatchTraceProcessor, run, setTraceProcessors, withTrace } from '@openai/agents';
import { RespanOpenAIAgentsTracingExporter } from '@respan/exporter-openai-agents';

setTraceProcessors([
  new BatchTraceProcessor(
    new RespanOpenAIAgentsTracingExporter(),
  ),
]);

const spanishAgent = new Agent({
  name: "Spanish agent",
  instructions: "You only speak Spanish.",
});

const englishAgent = new Agent({
  name: "English agent",
  instructions: "You only speak English",
});

const triageAgent = new Agent({
  name: "Triage agent",
  instructions: "Handoff to the appropriate agent based on the language of the request.",
  handoffs: [spanishAgent, englishAgent],
});

async function main() {
  const result = await withTrace("Handoff Example", async () => {
    return run(triageAgent, "Hola, ¿cómo estás?");
  });
  console.log(result.finalOutput);
}

main().catch(console.error);
```
</CodeGroup>

## Observability

With this integration, Respan auto-captures:

- **Agent runs** -- each agent execution as a span
- **LLM calls** -- model, input/output messages, token usage
- **Tool calls** -- function name, arguments, return value
- **Handoffs** -- which agent transferred control and to whom
- **Errors** -- failed runs and error details

View traces on the [Traces page](https://platform.respan.ai/platform/traces).

<Frame>
<img src="https://keywordsai-static.s3.us-east-1.amazonaws.com/docs/Integrations/openai-agents-metadata.png" alt="OpenAI Agents SDK trace in Respan" />
</Frame>
